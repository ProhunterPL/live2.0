# Realistic Chemistry Configuration
# Calibrated for chemically sensible molecules
# Based on literature values and experimental validation

mode: "open_chemistry"

# === GRID & TIMESTEP ===
grid_width: 128
grid_height: 128
dt: 0.05  # Smaller timestep = more stable dynamics
box_size: 100.0

# === PARTICLES ===
max_particles: 500
initial_particle_count: 100
particle_radius: 0.5

# === REALISTIC BONDING ===
# These parameters ensure bonds form ONLY at realistic distances
# and have realistic properties

# Formation thresholds
binding_threshold: 0.15      # Requires 15% probability (code has this check)
unbinding_threshold: 0.12    # Stable bonds need 12% to stay

# Bond checking frequency
bond_check_interval: 100     # Check every 100 steps
cluster_check_interval: 999999999  # Disable expensive cluster metrics (use catalog instead)

# === ENERGY & TEMPERATURE ===
energy_transfer_rate: 0.01
energy_dissipation: 0.01
thermostat_enabled: true
thermostat_target_temp: 300.0  # Room temperature (K)
thermostat_alpha: 0.05  # Gentle thermostat

# === NOVELTY DETECTION ===
novelty_check_interval: 300    # Frequent detection (was 700)
min_cluster_size: 3            # Meaningful molecules (3+ atoms)
detect_novel_substances: true
novelty_window: 500

# === VISUALIZATION ===
vis_frequency: 10
log_frequency: 200

# === VALIDATION ===
validate_every_n_steps: 200
enable_thermodynamic_validation: true
energy_tolerance: 0.002
momentum_tolerance: 0.0002

# === MUTATIONS ===
# Conservative mutations for realistic chemistry
p_mut_base: 0.002    # Low base mutation rate
p_mut_gain: 20.0      # Moderate gain
attr_sigma: 0.1       # Small attribute changes

# === NOTES ===
# With these parameters + the fixed code, you should see:
# - Density: 0.35-0.55 (realistic molecules)
# - Bond lengths: 0.8-1.8 units (not 2.0+)
# - Compact structures (not spider webs)
# - Stable clusters (don't dissolve quickly)
#
# The key fixes are in backend/sim/core/binding.py:
# - Line 344: binding_probability > 0.15 (not 0.005)
# - Line 317-319: max_formation_dist 1.2-1.8 (not 3.4)
# - Line 382-388: max_strain 0.3-0.8 (not 3.0)
#
# These code changes + this config = realistic chemistry!

